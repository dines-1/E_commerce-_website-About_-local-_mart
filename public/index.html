<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Local Mart - Your Neighborhood Store</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- Vue 3 CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body class="bg-gray-50">

<div id="app">
  <!-- Navbar -->
  <nav class="bg-white shadow-lg fixed top-0 w-full z-50">
    <div class="max-w-7xl mx-auto px-4 flex justify-between items-center h-16">
      <a href="#" class="text-2xl font-bold text-green-600">Local Mart</a>

      <div class="hidden md:flex space-x-8">
        <a href="#categories" class="text-gray-700 hover:text-green-600">Categories</a>
        <a href="#products" class="text-gray-700 hover:text-green-600">Products</a>
        <a href="#about" class="text-gray-700 hover:text-green-600">About</a>
        <a href="#reviews" class="text-gray-700 hover:text-green-600">Reviews</a>
      </div>

      <div class="flex items-center space-x-4">
        <template v-if="user">
          <span>{{ user.firstname }}</span>
          <a href="cart.php" class="relative">
            <i class="fas fa-shopping-cart text-xl"></i>
            <span class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">{{ cartCount }}</span>
          </a>
          <button @click="logout" class="text-red-600">Logout</button>
        </template>
        <template v-else>
          <a href="login.php" class="text-gray-700">Login</a>
          <a href="register.php" class="bg-green-600 text-white px-5 py-2 rounded-lg hover:bg-green-700">Sign Up</a>
        </template>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <section class="relative h-screen bg-cover bg-center" style="background-image: url('assets/hero-market.jpg')">
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="relative max-w-7xl mx-auto px-4 h-full flex items-center text-white">
      <div>
        <h1 class="text-5xl md:text-6xl font-bold mb-6">Fresh & Local,<br>Delivered Daily</h1>
        <p class="text-xl mb-8">Your trusted neighborhood store for groceries and daily needs.</p>
        <a href="#products" class="bg-green-600 text-white px-8 py-4 rounded-lg mr-4">Shop Now</a>
        <a href="#categories" class="border-2 border-white px-8 py-4 rounded-lg">Browse Categories</a>
      </div>
    </div>
  </section>

  <!-- Categories -->
  <section id="categories" class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-4xl font-bold text-center mb-12">Shop by Category</h2>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
        <template v-for="cat in categories" :key="cat.id">
          <a :href="'category.php?id=' + cat.id" class="group relative rounded-xl overflow-hidden shadow-lg">
            <img :src="cat.image_url || 'assets/default-cat.jpg'" class="w-full h-48 object-cover group-hover:scale-110 transition">
            <div class="absolute inset-0 bg-gradient-to-t from-black/70"></div>
            <div class="absolute bottom-4 left-4 text-white text-xl font-semibold">{{ cat.category_name }}</div>
          </a>
        </template>
      </div>
    </div>
  </section>

  <!-- Products -->
  <section id="products" class="py-16 bg-gray-100">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-4xl font-bold text-center mb-12">Featured Products</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
        <template v-for="p in products" :key="p.id">
          <div class="bg-white rounded-lg shadow overflow-hidden">
            <a :href="'product.php?id=' + p.id">
              <img :src="firstImage(p.images)" class="w-full h-56 object-cover">
            </a>
            <div class="p-4">
              <p class="text-sm text-gray-500">{{ p.category_name }}</p>
              <h3 class="font-semibold text-lg">{{ p.product_name }}</h3>
              <div class="flex justify-between items-center mt-4">
                <span class="text-2xl font-bold text-green-600">₹{{ p.price }}</span>
                <a :href="'add-to-cart.php?id=' + p.id" class="bg-green-600 text-white px-4 py-2 rounded text-sm">
                  Add to Cart
                </a>
              </div>
            </div>
          </div>
        </template>
      </div>
    </div>
  </section>

  <!-- About -->
  <section id="about" class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 grid md:grid-cols-2 gap-12 items-center">
      <div>
        <h2 class="text-4xl font-bold mb-6">About Local Mart</h2>
        <p class="text-gray-600 mb-6">Serving our community since 2015 with fresh groceries and daily essentials.</p>
        <div class="grid grid-cols-3 gap-6 text-center">
          <div><h3 class="text-3xl font-bold text-green-600">500+</h3><p>Happy Customers</p></div>
          <div><h3 class="text-3xl font-bold text-green-600">50+</h3><p>Local Suppliers</p></div>
          <div><h3 class="text-3xl font-bold text-green-600">24/7</h3><p>Fast Delivery</p></div>
        </div>
      </div>
      <img src="assets/about-store.jpg" class="rounded-xl shadow-lg">
    </div>
  </section>

  <!-- Reviews -->
  <section id="reviews" class="py-16 bg-gray-100">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-4xl font-bold text-center mb-12">Customer Reviews</h2>
      <div class="grid md:grid-cols-3 gap-8">
        <template v-for="r in reviews" :key="r.id">
          <div class="bg-white p-6 rounded-lg shadow">
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center font-bold">
                {{ r.firstname[0] }}
              </div>
              <div class="ml-4">
                <h4 class="font-semibold">{{ r.firstname }}</h4>
                <p class="text-sm text-gray-500">on {{ r.product_name }}</p>
              </div>
            </div>
            <div class="flex mb-3">
              <i v-for="n in 5" :key="n" :class="n <= r.rating ? 'fas text-yellow-400' : 'far text-gray-300'" class="fa-star"></i>
            </div>
            <p class="text-gray-700">{{ r.review_text || 'Great product!' }}</p>
          </div>
        </template>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white py-12">
    <div class="max-w-7xl mx-auto px-4 grid md:grid-cols-4 gap-8">
      <div>
        <h3 class="text-2xl font-bold mb-4">Local Mart</h3>
        <p class="text-gray-400">Your trusted local store.</p>
      </div>
      <div>
        <h4 class="font-semibold mb-4">Quick Links</h4>
        <ul class="space-y-2 text-gray-400">
          <li><a href="#" class="hover:text-white">About</a></li>
          <li><a href="#" class="hover:text-white">Contact</a></li>
          <li><a href="#" class="hover:text-white">Privacy</a></li>
        </ul>
      </div>
      <div>
        <h4 class="font-semibold mb-4">Contact</h4>
        <p class="text-gray-400">+91 98765 43210<br>hello@localmart.in</p>
      </div>
    </div>
    <div class="text-center text-gray-500 text-sm mt-8">
      © 2025 Local Mart. All rights reserved.
    </div>
  </footer>
</div>

<script>
const { createApp, ref, onMounted } = Vue;

createApp({
  setup() {
    const user = ref(null);
    const cartCount = ref(0);
    const categories = ref([]);
    const products = ref([]);
    const reviews = ref([]);

    const firstImage = (imagesJson) => {
      if (!imagesJson) return 'assets/default-product.jpg';
      const imgs = JSON.parse(imagesJson);
      return imgs[0] || 'assets/default-product.jpg';
    };

    const loadData = async () => {
      try {
        // Check login status
        const userRes = await axios.get('api/check-login.php');
        if (userRes.data.loggedin) user.value = userRes.data.user;

        // Load categories, products, reviews
        const [catRes, prodRes, revRes] = await Promise.all([
          axios.get('api/categories.php'),
          axios.get('api/products.php?limit=8'),
          axios.get('api/reviews.php?limit=6')
        ]);

        categories.value = catRes.data;
        products.value = prodRes.data;
        reviews.value = revRes.data;
      } catch (e) {
        console.error(e);
      }
    };

    const logout = () => {
      axios.get('api/logout.php').then(() => location.reload());
    };

    onMounted(loadData);

    return { user, cartCount, categories, products, reviews, firstImage, logout };
  }
}).mount('#app');
</script>

</body>
</html>